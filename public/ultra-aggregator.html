<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–£–ª—å—Ç—Ä–∞ –í–∏–¥–µ–æ –ê–≥—Ä–µ–≥–∞—Ç–æ—Ä + –°—Ç—Ä–∏–º–∏–Ω–≥</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',sans-serif;background:#050714;color:#fff;min-height:100vh}
.container{max-width:1200px;margin:auto;padding:20px}
header{text-align:center;padding:40px 0}
h1{font-size:3em;font-weight:800;background:linear-gradient(135deg,#a18cd1,#fbc2eb);-webkit-background-clip:text;-webkit-text-fill-color:transparent}

.input-section{background:rgba(255,255,255,.05);padding:25px;border-radius:20px;margin-bottom:30px}
.input-group{display:flex;gap:10px}
input{flex:1;padding:15px;border-radius:12px;border:none;font-size:16px}
button{padding:0 30px;border:none;border-radius:12px;font-weight:700;cursor:pointer;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}

.video-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:20px}
.video-card{background:rgba(255,255,255,.05);border-radius:18px;cursor:pointer;transition:.3s;position:relative}
.video-card:hover{transform:translateY(-5px)}
.video-thumbnail{aspect-ratio:16/9;display:flex;align-items:center;justify-content:center;font-size:2.5em;flex-direction:column}
.platform-tag{font-size:12px;opacity:.5}

.delete-btn{position:absolute;top:10px;right:10px;width:30px;height:30px;border-radius:50%;background:red;color:#fff;border:none}

.modal{display:none;position:fixed;inset:0;background:#000;z-index:999}
.modal.active{display:flex;align-items:center;justify-content:center}
.modal-content{width:100%;max-width:1200px;aspect-ratio:16/9}
.player-viewport{width:100%;height:100%;position:relative;overflow:hidden}

iframe{position:absolute;top:-15%;left:-5%;width:110%;height:130%;border:none;visibility:hidden}
iframe.visible{visibility:visible}

.crop-ultra iframe{top:-20%;height:140%}

.close-modal{position:absolute;top:10px;right:20px;font-size:3em;color:#fff;background:none;border:none;cursor:pointer}
</style>
</head>

<body>
<div class="container">
<header>
<h1>–£–ª—å—Ç—Ä–∞ –ê–≥—Ä–µ–≥–∞—Ç–æ—Ä</h1>
<p style="opacity:.5">Twitch ‚Ä¢ Kick ‚Ä¢ VK ‚Ä¢ YouTube ‚Ä¢ Rutube ‚Ä¢ Trovo ‚Ä¢ GoodGame ‚Ä¢ OK ‚Ä¢ Matreshka</p>
</header>

<div class="input-section">
<div class="input-group">
<input id="videoUrl" placeholder="–í—Å—Ç–∞–≤—å —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∏–¥–µ–æ –∏–ª–∏ —Å—Ç—Ä–∏–º">
<button onclick="addVideo()">–î–æ–±–∞–≤–∏—Ç—å</button>
</div>
</div>

<div class="video-list" id="videoList"></div>
</div>

<div class="modal" id="videoModal">
<button class="close-modal" onclick="closeModal()">‚úï</button>
<div class="modal-content">
<div class="player-viewport" id="viewport">
<iframe id="vPlayer" allow="autoplay;fullscreen"></iframe>
</div>
</div>
</div>

<script>
let savedVideos = JSON.parse(localStorage.getItem('ultra_full')) || [];

function save(){localStorage.setItem('ultra_full',JSON.stringify(savedVideos))}
function render(){
videoList.innerHTML = savedVideos.map(v=>`
<div class="video-card" onclick="play(${v.id})">
<button class="delete-btn" onclick="event.stopPropagation();del(${v.id})">‚úï</button>
<div class="video-thumbnail">
üé¨
<div class="platform-tag">${v.platform}</div>
</div>
</div>`).join('');
}

function parseLink(url){
let p='generic',embed='',crop='standard';
const parent=location.hostname;

if(/twitch\.tv/.test(url)){
p='twitch';embed=`https://player.twitch.tv/?channel=${url.split('/').pop()}&parent=${parent}&autoplay=true`;
}
else if(/kick\.com/.test(url)){
p='kick';embed=`https://player.kick.com/${url.split('/').pop()}`;
}
else if(/trovo\.live/.test(url)){
p='trovo';embed=`https://player.trovo.live/embed/player?streamername=${url.split('/').pop()}&autoplay=true`;
}
else if(/goodgame\.ru/.test(url)){
p='goodgame';embed=`https://goodgame.ru/player?stream=${url.split('/').pop()}`;
}
else if(/live\.vkvideo\.ru/.test(url)){
p='vk_live';embed=`https://live.vkvideo.ru/embed/${url.split('/').pop()}`;
}
else if(/vk\.com|vkvideo\.ru/.test(url)){
p='vk';const m=url.match(/video(-?\d+)_(\d+)/);
if(m)embed=`https://vk.com/video_ext.php?oid=${m[1]}&id=${m[2]}&autoplay=1`;
}
else if(/youtube|youtu\.be/.test(url)){
p='youtube';crop='ultra';
const id=url.match(/(?:v=|\/)([a-zA-Z0-9_-]{11})/)?.[1];
embed=`https://www.youtube-nocookie.com/embed/${id}?autoplay=1&controls=0`;
}
else if(/rutube\.ru/.test(url)){
p='rutube';crop='ultra';
const id=url.match(/\/video\/([a-f0-9]+)/)?.[1];
embed=`https://rutube.ru/play/embed/${id}?autoplay=1`;
}
else if(/vimeo\.com/.test(url)){
p='vimeo';embed=`https://player.vimeo.com/video/${url.split('/').pop()}?autoplay=1`;
}
else if(/dailymotion/.test(url)){
p='dailymotion';embed=`https://www.dailymotion.com/embed/video/${url.split('/').pop()}`;
}
else if(/ok\.ru/.test(url)){
p='ok';embed=`https://ok.ru/videoembed/${url.split('/').pop()}`;
}
else if(/matreshka\.tv/.test(url)){
p='matreshka';embed=`https://matreshka.tv/en/embed/${url.split('/').pop()}?autoplay=1`;
}
else{
embed=url;
}

return embed?{id:Date.now(),platform:p,url:embed,crop}:null;
}

function addVideo(){
const v=parseLink(videoUrl.value.trim());
if(!v)return alert('–°—Å—ã–ª–∫–∞ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞');
savedVideos.unshift(v);save();render();videoUrl.value='';
}

function play(id){
const v=savedVideos.find(x=>x.id===id);
videoModal.classList.add('active');
viewport.className='player-viewport';
if(v.crop==='ultra')viewport.classList.add('crop-ultra');
vPlayer.src=v.url;
vPlayer.classList.add('visible');
}

function del(id){savedVideos=savedVideos.filter(v=>v.id!==id);save();render()}
function closeModal(){videoModal.classList.remove('active');vPlayer.src=''}

render();
</script>
</body>
</html>

